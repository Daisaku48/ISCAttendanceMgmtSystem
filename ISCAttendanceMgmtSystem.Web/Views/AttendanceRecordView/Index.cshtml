﻿@using ISCAttendanceMgmtSystem.COM.Entity.Session

@using ISCAttendanceMgmtSystem.COM.Models
@model AttendanceRecordViewModels

@{
    ViewBag.Title = "勤務実績確認";
}
@Styles.Render("~/Content/css/attend-view")


@using (Html.BeginForm("Index", "AttendanceRecordView", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { @class = "form-horizontal" }))
{
    <!--検索項目-->
    @Html.HiddenFor(m => m.Down.DownloadFlag)
    <div class="row">
        <div class="col-xs-offset-1 col-xs-10">
            <!--タイトル-->
            <h3 class="text-left">勤務実績確認</h3>
        </div>
    </div>

    @Html.HiddenFor(m => m.Search.EmployeeNo)


    <div class="row">
        <div class="col-xs-offset-1 col-xs-10">
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        </div>
    </div>


    //検索条件
    //年月日
    var yearItems = new SelectListItem[] {
                            new SelectListItem() { Value="2022", Text="2022" },new SelectListItem() { Value="2023", Text="2023" },new SelectListItem() { Value="2024", Text="2024" },
                            new SelectListItem() { Value="2025", Text="2025" },new SelectListItem() { Value="2026", Text="2026" },new SelectListItem() { Value="2027", Text="2027" },new SelectListItem() { Value="2028", Text="2028" },new SelectListItem() { Value="2029", Text="2029" },
                            new SelectListItem() { Value="2030", Text="2030" }
    };
    var monthItems = new SelectListItem[] {
                            new SelectListItem() { Value="1", Text="1" },new SelectListItem() { Value="2", Text="2" },new SelectListItem() { Value="3", Text="3" },
                            new SelectListItem() { Value="4", Text="4" },new SelectListItem() { Value="5", Text="5" },new SelectListItem() { Value="6", Text="6" },new SelectListItem() { Value="7", Text="7" },new SelectListItem() { Value="8", Text="8" },
                            new SelectListItem() { Value="9", Text="9" },new SelectListItem() { Value="10", Text="10" },new SelectListItem() { Value="11", Text="11" },new SelectListItem() { Value="12", Text="12" }
    };


    <div class="row">
        <div class="col-xs-offset-1 col-xs-8">
            <div class="search-group">
                <label class="search-label ">Year</label>
                @Html.DropDownList("Search.EntryYear", new SelectList((IEnumerable<SelectListItem>)yearItems, "Value", "Text", Model.Search.EntryYear), "", new { @class = "search-input" })
                <label class="search-label ">Month</label>
                @Html.DropDownList("Search.EntryMonth", new SelectList((IEnumerable<SelectListItem>)monthItems, "Value", "Text", Model.Search.EntryMonth), "", new { @class = "ime-disabled" })

                <input type="button" name="DmySearchEx" value="検索" class="btn-default" id="dmysearch"/>

            </div>
            <div class="download-group">
                <input type="button" name="DmyDateDownload" value="ダウンロード" class="btn-default pull-right" id="dmydatedownload"/>
            </div>
        </div>
    </div>

    <!--一覧-->
    <div class="row top17">
        <div class="col-xs-1"></div>
        <div class="col-xs-8">
            <table class="table-bordered table-striped table-ecell-show mb-zero table-sch">
                <colgroup>
                    <col style="width:50px" />
                    <col style="width:50px" />
                    <col style="width: 114px" />
                    <col style="width:90px" />
                    <col style="width:90px" />
                    <col style="width:90px" />
                    <col style="width:90px" />
                    <col style="width:90px" />
                    <col style="width:90px" />
                    <col style="width:90px" />
                </colgroup>
                <thead>
                    <tr style="background-color: #ebe2c5;" class="allCheck">
                        <th class="sch-th" rowspan="2">日付</th>
                        <th class="sch-th" rowspan="2">曜日</th>
                        <th class="sch-th" rowspan="2">勤務形態</th>
                        <th class="sch-th" rowspan="2">出社</th>
                        <th class="sch-th" rowspan="2">休憩開始</th>
                        <th class="sch-th" rowspan="2">休憩終了</th>
                        <th class="sch-th" rowspan="2">退社</th>
                        <th class="sch-th" rowspan="2">勤務合計</th>
                        <th class="sch-th" rowspan="1" colspan="2">時間外</th>
                    </tr>
                    <tr style="background-color: #ebe2c5;" class="allCheck">
                        <th class="sch-th">(22時以前)</th>
                        <th class="sch-th">(22時以降)</th>
                    </tr>
                </thead>
            </table>

            <table class="table table-bordered table-striped table-ecell-show scrollTable" style="height:520px;">
                <tbody class="tblscroll" id="items" style="height:520px;">
                    @if (Model != null && Model.SearchResult != null)
                    {
                        foreach (AttendanceRecordViewListModel row in Model.SearchResult)
                        {
                            <tr>
                                <td class="text-center" style="width: 50px;">@Html.DisplayTextFor(m => row.ViewDay)</td>
                                <td class="text-center" style="width: 50px;">@Html.DisplayTextFor(m => row.ViewWeek)</td>
                                <td class="text-center" style="width: 114px;">@Html.DisplayTextFor(m => row.AttendanceType)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.StampTimeBegin)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.RestStampTimeBegin)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.RestStampTimeFinish)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.StampTimeFinish)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.WorkingTimeTotal)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.WorkingOffTime1)</td>
                                <td class="text-center" style="width: 90px;">@Html.DisplayTextFor(m => row.WorkingOffTime2)</td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>

    @*隠しボタンエリア*@
    <div style="height:0px;">
        <button type="submit" name="SearchEx" value="検索" class="btn invisible" id="searchbutton">検索</button>
        <button type="submit" name="DateDownload" value="データ出力" class="btn invisible" id="datedownloadbutton">データダウンロード</button>
    </div>

    <div>
        @if (Model.Down.DownloadFlag)
        {
            //jsファイルで読込む形にする;
            @Scripts.Render("~/Scripts/js/objp")
        }
    </div>

    @Scripts.Render("~/Scripts/js/attend-view")
}
